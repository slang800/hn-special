// Animations
@keyframes flash
  0%
    left 0px

  25%
    left -12px

  50%
    left 0px

  75%
    left 12px

  100%
    left 0px

@keyframes link-flash
  from
    opacity 0.2
    transform translateX(1000px)

  to
    opacity 1
    transform translateX(0px)

@keyframes slide-up
  from
    bottom -200px
    opacity 0

  60%
    bottom 90px
    opacity 1

  to
    bottom 30px
    opacity 1

@keyframes slide-out-right
  from
    right 20px
    opacity 1

  60%
    right 80px
    opacity 1

  to
    right -500px
    opacity 0

// Generic buttons (abstract styles)
$text-button
  font inherit
  border none
  font-weight 200
  background none
  cursor pointer
  margin 0
  padding 0
  color text-button-color

  &:hover
    text-decoration underline

$hnspecial-text-button
  color link-color

$hnspecial-button
  font unquote(base-font)
  padding 5px 8px
  margin 0
  font-weight 200

  background base-color
  border none
  color light-link-color
  cursor pointer

  &:active
    color text-button-active-color
    background darken(base-color, 10%)


// HN Special infinite scroll
.hnspecial-infinite-pause
  padding-left 5px
  color text-button-color !important
  &:before
    content '|'
    margin-right 5px

// Used by highlight_links_when_returning
.hnspecial-theme-link-flash
  &, & + tr
    animation link-flash 1s ease

// HNSpecial theme styles
html.hnspecial-theme-preload body
  display none

html.hnspecial-theme
  body
    display block

  &, body
    background page-background-color
    margin 0
    padding 0
    font unquote(base-font)
    color text-color

  u
    text-decoration none

  a
    color link-color
    text-decoration none

  a:hover
    /*color #fdbe80*/
    text-decoration underline

  // Used in posts and comments
  p
    line-height 1.5
    margin 0
    margin-bottom 1em
    color lighten(text-color, 0%)
    font-weight 200
    word-wrap break-word

  input[type=submit], input[type=button]
    @extend $hnspecial-button

  button.hnspecial-button
    @extend $hnspecial-button

  input:focus, button:focus
    outline none

  textarea
    width 100%
    height 120px
    resize vertical

  textarea, input[type="text"], input[type="password"]
    background darken(page-background-color, 20%)
    border 1px solid darken(page-background-color, 50%)
    font unquote(base-font)
    font-weight 200
    padding 5px 8px
    margin 0
    color text-color

  // Pre and code tags can stretch the page if not limited
  pre
    overflow auto
    max-width 600px
    word-wrap normal
    white-space pre

  code
    font 12px/1.5 "Monaco", "Consolas", "Lucida Console", "Courier New", monospace
    color lighten(text-color, 30%)

  table
    border-collapse collapse
    border none

  tr, td
    border none
    padding 0

  // Some selectors are pretty contrived but I think it's the only
  // way to select some things. Please correct me if I'm wrong!
  &.error body
    text-align center
    padding-top 140px
    font-size 40px
    font-weight 100
    letter-spacing 1px

    a
      display block
      font-size 20px
      font-weight 100

  // Secondary pages
  .WordSection1
    width 900px
    margin 0 auto
    padding 50px 0

    .MsoNormal
      margin 15px 0

  // HN Special infinite scroll
  .hnspecial-infinite-pause
    padding 0
    margin-left 20px
    font-size 13px
    text-transform lowercase
    color lighten(text-color, 40%)
    &:before
      content normal

  &.hnspecial-form-page
    form
      td
        font-weight 200
        padding-bottom 20px

        &:first-child
          text-transform capitalize
          padding-right 30px

          &.hnspecial-textarea-label
            vertical-align top
            padding-top 8px

      b
        font-weight 200

    &.login .hnspecial-form-container
      width 300px
      margin 0 auto
      padding-top 100px

      input[type=submit]
        width 130px

      b
        font-size 40px
        font-weight 100
        letter-spacing 1px

      td:last-child
        &, input
          width 100%

  // Comment spacers
  .hnspecial-theme-spacer-cell
    overflow hidden
    position relative

  .hnspecial-theme-spacer
    position absolute
    top 0
    bottom 0
    left 7px
    width 1px
    background comment-spacer-color

  // Shows HN Special color next to topcolor input
  input[name="topcolor"] + p
    margin-left 20px
    strong
      font-weight 400
    &, pre
      display inline

  // Topcolors in topcolors page
  .hnspecial-theme-topcolor-preview
    width 17px
    height 17px
    margin-left 20px
    display inline-block
    position absolute
    left 100px

  // Primary pages
  body > center
    display block
    max-width 900px
    margin 0 auto // Add an option to disable this

    > table
      width 100%

      // Header
      > tbody
        > tr:first-child > td
          background base-color !important

          > table
            color light-link-color
            font-weight 100
            width 100%

            b
              font-weight inherit
              margin 0

            td
              padding 20px 0

              // Logo td
              &:first-child
                square-size = 30px
                width square-size

                padding-left 25px
                padding-right 10px

                a
                  display block
                  width square-size
                  height square-size

                  &:hover
                    text-decoration none

              // Title and links td
              &:nth-child(2)
                font
                  display inline-block
                  overflow hidden
                  letter-spacing 1px
                  max-width 140px
                  white-space nowrap
                  text-overflow ellipsis

                b a
                    margin-right 25px
                    font-weight 400
                    letter-spacing 0px

                // Remove spacer gif
                img
                  display none

                .pagetop
                  > a, > .topsel
                    margin-right 10px

                  .topsel a
                    font-weight 300

              // User td
              &:last-child
                text-align right
                padding-right 25px

                a[href^=logout]
                  margin-left 5px

            a
              font-weight 100
              letter-spacing 1px
              color light-link-color

        // Contents
        > tr:nth-child(3) > td
          padding 42px 20px 0 20px

          tr >
            // It's the only proper way to style the leaderboard tables
            columns = 4
            for num in (1..columns)
              td:nth-child({num}):nth-last-child({columns - num + 1}):not(:empty)
                padding 0 !important
                padding-top 15px !important
                if num == 2
                  padding-left 10px !important
                  width 100%

                if num == 3
                  padding-right 30px !important

          // Post area
          > table:first-of-type
            width 100%
            font-weight 200
            color lighten(text-color, 40%)

            > tbody
              > tr:first-child >
                td:first-child:not(.hnspecial-upvote-button):not(.title) > center // Arrow td next to title in comments page
                  padding 0px 13px 3px 10px // Refactor: same as #1

                td:nth-child(3):not(.title) // Heading above job listings page
                  padding-bottom 30px
                  line-height 1.5

              // Add spacing to leaders table
              tr td:first-child
                > a
                  display block
                  padding-top 7px
                  padding-bottom 8px


              form
                padding-top 30px
                margin 0

                input[type=submit]
                  width 150px

          // Comments
          .default
            padding-top 20px

            font[color="#737373"]
              color text-showdead-color

            font[color="#888888"],
            font[color="#5a5a5a"],
            font[color="#000000"]
              color text-color

            // Comment info & reply button
            .comhead, u
              font-weight 200
              font-size 13px
              color lighten(text-color, 40%)

              font[color="#3c963c"]
                color text-new-user-color

          // Custom class added to poll items
          .hnspecial-poll-row + tr td
            padding-top 5px
            padding-bottom 20px

          // Custom class added by js on the comment upvote button
          .hnspecial-upvote-button
            padding-right 13px
            vertical-align top

            &.poll center
              padding-top 1px

            center
              padding-top 20px !important

          td.comment
            font-weight 200

          td.title
            padding 3px 0 5px 0

            &:last-child
              width 100%

            + td
              padding 0px 13px 3px 10px // Refactor: same as #1

            a
              color link-color

              &:visited
                color link-visited-color

          td.subtext
            font-size 13px
            padding-bottom 22px

            font[color="#3c963c"]
              color text-new-user-color

        > tr:nth-child(4) > td
          padding-top 30px
          font-weight 200
          font-size 13px

          .yclinks a
              margin-right 10px

          form input
            width 400px
            margin-left 10px
            background darken(page-background-color, 20%)
            border 1px solid darken(page-background-color, 50%)

  // Infinite scrolling separator
  .hnspecial-infinite-scroll-separator
    span
      margin 0
      position absolute
      font-size 13px
      background comment-spacer-color
      right 15px
      top -9px
      padding 0 10px

    td
      position relative

      &:after
        margin-top 0
        height 20px

  // Fold comments button
  .hnspecial-fold-comment-button
    @extend $hnspecial-text-button

// Upvote/downvote arrow
.votelinks
  a[id^=up_], a[id^=down_]
    opacity 0.3
    display inline-block
    transition all 150ms ease

    &:hover
      opacity 0.6

    &:active
      opacity 0.3

.votearrow
  // create triangles with CSS so we don't need an extra asset
  width 0 !important
  height 0 !important
  border-left: 5px solid transparent
  border-right: 5px solid transparent

  &[title="upvote"]
    border-bottom: 7px solid arrow-color

  &[title="downvote"]
    border-top: 7px solid arrow-color

// END Visual theme specific styles

// Special message container
.hnspecial-message-container
  background page-background-color
  color light-link-color
  text-align center
  font-weight 200
  padding-top 20px

// Infinite scrolling separator
.hnspecial-infinite-scroll-separator td
  span
    display block
    margin-top 10px

  &:after
    margin-top 5px
    height 17px
    content ''
    width 100%
    display block
    border-top 1px solid comment-spacer-color

// Infinite scrolling notice
.hnspecial-infinite-search-notice
  position fixed
  right 20px
  bottom 30px
  width 400px
  background menu-background
  padding 20px
  font-weight 200
  cursor pointer
  animation slide-up 800ms ease

  span
    color lighten(text-color, 40%)
    font-size 13px

  &.hnspecial-infinite-search-notice-hidden
    animation slide-out-right 450ms ease
    animation-fill-mode both

// Fold comments
.hnspecial-fold-comment-button
  @extend $text-button

.hnspecial-folded-comment
  > *:not(:first-child)
    display none

.hnspecial-folded-row
  display none

.hn-special-tooltip
  color tooltip-text-color
  background-color tooltip-background-color

.hn-special-tooltip-container
  &:before
    border-bottom-color tooltip-background-color

  &.hn-special-tooltip-inverted:before
    border-top-color tooltip-background-color
